---
import '../styles/global.css';
import profile from '../data/profile.json';

interface Props {
  title?: string;
  description?: string;
}

const {
  title = profile.name,
  description = profile.tagline
} = Astro.props;

const currentPath = Astro.url.pathname;

function isActive(path: string): boolean {
  if (path === '/') {
    return currentPath === '/';
  }
  return currentPath.startsWith(path);
}
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <title>{title}</title>
  </head>
  <body>
    <header class="header">
      <nav class="nav">
        <a href="/" class="nav-logo">Kimberly</a>

        <button class="nav-toggle" aria-label="Toggle navigation" id="nav-toggle">
          <span></span>
          <span></span>
          <span></span>
        </button>

        <ul class="nav-links" id="nav-links">
          <li>
            <a href="/" class:list={["nav-link", { active: isActive('/') && currentPath === '/' }]}>
              Home
            </a>
          </li>
          <li>
            <a href="/about" class:list={["nav-link", { active: isActive('/about') }]}>
              About
            </a>
          </li>
          <li class="nav-item">
            <a href="/competitions/past" class:list={["nav-link", { active: isActive('/competitions') }]}>
              Competitions
            </a>
            <div class="nav-dropdown">
              <ul class="nav-dropdown-menu">
                <li>
                  <a href="/competitions/past" class="nav-dropdown-link">Past</a>
                </li>
                <li>
                  <a href="/competitions/upcoming" class="nav-dropdown-link">Upcoming</a>
                </li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a href="/workshops/past" class:list={["nav-link", { active: isActive('/workshops') }]}>
              Workshops
            </a>
            <div class="nav-dropdown">
              <ul class="nav-dropdown-menu">
                <li>
                  <a href="/workshops/past" class="nav-dropdown-link">Past</a>
                </li>
                <li>
                  <a href="/workshops/upcoming" class="nav-dropdown-link">Upcoming</a>
                </li>
              </ul>
            </div>
          </li>
        </ul>
      </nav>
    </header>

    <main class="main-content">
      <slot />
    </main>

    <footer class="footer">
      <div class="footer-content">
        <span class="footer-logo">Kimberly Matos</span>
        <span class="footer-text">
          © {new Date().getFullYear()} · Made with love by
          <a href="https://p.ocmatos.com" target="_blank" rel="noopener">Dad</a>
        </span>
      </div>
    </footer>

    <script>
      const toggle = document.getElementById('nav-toggle');
      const links = document.getElementById('nav-links');

      toggle?.addEventListener('click', () => {
        links?.classList.toggle('active');
      });
    </script>
  </body>
</html>
